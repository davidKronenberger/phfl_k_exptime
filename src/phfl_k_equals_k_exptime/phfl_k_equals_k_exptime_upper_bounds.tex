\section{Upper Bound of PHFL$^k$}
\label{sec:phfl_k_equals_k_exptime_upper_bounds}
To show that the upper bound of PHFL$^k$ is \exptime{$k$} we want to make a reduction from the model checking
problem of PHFL$^k$ to the model checking problem of HFL$^k$. Remember, that HFL$^k$ is set of $1$-adic PHFL$^k$
formulas. In combination to the following theorem we get the upper bound of PHFL$^k$.

\begin{theorem}{\cite{axelsson2007complexity}}
    \label{theorem:hfl_k_in_k_exptime}
    The model checking problem of HFL$^k$ formulas lies in $k$-EXPTIME, where $k > 0$.
\end{theorem}

\begin{lemma}
    \label{lemma:model_check_phfl_k}
    The model checking problem of PHFL$^k$ formulas is reducible to the model checking problem of HFL$^k$ formulas.
\end{lemma}

\begin{proof}
    To reduce the model checking problem of PHFL$^k$ to the model checking problem of HFL$^k$, we have to transform
    the input LTS $\mathcal{T}$ and the input formula $\varphi$ of the problem $\mathcal{T}, \emph{s}
    \overset{?}{\models} \varphi$.
    Let $\mathcal{T}_{PHFL} = (Q, \Sigma, P, \Delta_{PHFL}, \nu_{PHFL})$ a LTS and $\emph{s} = (s_1, \dots, s_d)$ a
    state tuple to check if it is a model of a $d$-adic PHFL$^k$ formula $\varphi_{PHFL}$, i.e. $\mathcal{T}_{PHFL}
    \overset{?}{\models} \varphi_{PHFL}$. Then $\mathcal{T}_{HFL} = (Q \times \dots \times Q, \Sigma_1 \cup \dots
    \cup \Sigma_d, P_1 \times \dots \times P_d, \Delta_{HFL}, \nu_{HFL})$, where
    \begin{compactitem}
        \item $\Sigma_i = \{a_i \mid a \in \Sigma\}$,
        \item $P_i = \{p_i \mid p \in P\}$,
        \item $i \in \{1, \dots, d\}$,
        \item $\Delta_{HFL} =$
        \begin{align*}
                  &\,\{((q_1, \dots, q_d), a_i, ({q_1}', \dots, {q_d}')) \mid (q, a, q') \in \Delta_{PHFL}
                  \wedge i \in \{1, \dots, d\} \\&\wedge a_i \in \Sigma_i \wedge q_i = q \wedge {q_i}' = q' \wedge
                  \forall j \neq i.\, q_j = {q_j}'\}  \\
                  \cup & \,\{((q_1, \dots, q_{i_1 - 1}, q_{i_1}, q_{i_1 + 1}, \dots, q_d), s_{(i_1) \leftarrow (j_1)
                  }, \\&
                  (q_1, \dots, q_{i_1 - 1}, q_{j_1}, q_{i_1 + 1}, \dots, q_d)) \mid \\&
                  i_1, j_1 \in \{1, \dots, d\} \wedge (q_{i_1}, a_1, q_{j_1}) \in \Delta_{PHFL} \wedge a_1 \in
                  \Sigma\} \\
                  \cup & \,\{((q_1, \dots, q_{i_1 - 1}, q_{i_1}, q_{i_1 + 1}, \dots, q_{i_2 - 1}, q_{i_2}, q_{i_2 +
                  1}, \dots, q_d), s_{(i_1, i_2) \leftarrow (j_1, j_2)}, \\&
                  (q_1, \dots, q_{i_1 - 1}, q_{j_1}, q_{i_1 + 1}, \dots, q_{i_2 - 1}, q_{j_2}, q_{i_2 + 1}, \dots, q_d))
                  \mid \\& i_1, i_2, j_1, j_2 \in \{1, \dots, d\} \wedge i_1 \neq i_2 \wedge j_1 \neq j_2 \,\wedge\\&
                   (q_{i_1}, a_1, q_{j_1}) \in \Delta_{PHFL} \wedge (q_{i_2}, a_2, q_{j_2}) \in \Delta_{PHFL}
                  \wedge a_1, a_2 \in \Sigma\} \\
            \cup &\\
            &\dots \\
                  \cup & \,\{((q_{i_1}, \dots, q_{i_d}), s_{(i_1, \dots, i_d) \leftarrow
                  (j_1, \dots, j_d)},
                  (q_{j_1}, \dots, q_{j_d})) \mid \\&
                  i_1, \dots, i_d, j_1, \dots, j_d \in \{1, \dots, d\} \wedge i_1 \neq \dots \neq i_d \wedge j_1
                  \neq \dots \neq j_d \,\wedge\\& (q_{i_1}, a_1,  q_{j_1}) \in
                  \Delta_{PHFL} \wedge \dots \wedge (q_{i_d}, a_d, q_{j_d}) \in \Delta_{PHFL}
                  \wedge a_1, \dots a_d \in \Sigma\}
        \end{align*} and
        \item $\nu_{HFL} \colon Q \times \dots \times Q \rightarrow 2^{P_1, \dots, P_d}, $

        $\nu_{HFL}((q_1, \dots, q_d)) = \{p_1 \mid p \in \nu_{PHFL}(q_1)\} \cup \dots \cup \{p_d \mid p \in
        \nu_{PHFL}(q_d)\}$,
    \end{compactitem}
    is the transformed LTS to check if it is a model of the transformed HFL formula $\varphi_{HFL}$, i.e.
    $\mathcal{T}_{HFL}, \emph{s} \overset{?}{\models} \varphi_{HFL}$. As mentioned above, the PHFL$^k$ formula
    $\varphi_{PHFL}$ has also be transformed to $\varphi_{HFL}$. For this let $\psi_{PHFL}$ a subformula of
    $\varphi_{PHFL}$ and $\psi_{HFL}$ a subformula of $\varphi_{HFL}$. All subformulas of the form $\psi_{PHFL} =
    \langle a \rangle_i \Phi$ for $i \in \{1, \dots, d\}$ will be transformed to $\psi_{HFL} = \langle
    a_i \rangle \Phi$. Next, we have to transform all subformulas of the form $\psi_{PHFL} = \{\emph{i}
    \leftarrow \emph{j}\} \Phi$, where $\emph{i} = (i_1, \dots, i_n)$, $\emph{j} = (j_i, \dots, j_n)$ and $n, i_1,
    \dots, i_n, j_1, \dots, j_n \in \{1, \dots, d\}$, to $\psi_{HFL} = \langle s_{\emph{i} \leftarrow \emph{j}}
    \rangle \Phi$. All other subormulas have not to be transformed.

    Next, we want to show the correctness of this construction. For this, we prove by induction on formula
    $\varphi_{PHFL}$: $\mathcal{T}_{PHFL}, \emph{s} \models \varphi_{PHFL}$ iff $\mathcal{T}_{HFL}, \emph{s} \models
    \varphi_{HFL}$, where $\emph{s} = (s_1, \dots, s_d)$. The only important induction basis case is that of
    propositions.
    \begin{compactitem}
        \item $\varphi_{PHFL} = p_i \colon $

        $\mathcal{T}_{PHFL}, \emph{s} \models \varphi_{PHFL}$

        iff $p \in \nu_{PHFL}(s_i)$

        iff $p_i \in \nu_{HFL}(\emph{s})$

        iff $\mathcal{T}_{HFL}, \emph{s} \models \varphi_{HFL}$ where $\varphi_{HFL} = p_i$.
    \end{compactitem}

    The following cases are the only non-trivial one to show the correctness. The other cases do not use the
    modal operators and are handled as in PHFL$^k$.

    \begin{compactitem}
        \item $\varphi_{PHFL} = \langle a \rangle_i \psi_{PHFL} \colon $

        $\mathcal{T}_{PHFL}, \emph{s} \models \varphi_{PHFL}$

        iff $\exists \emph{s'}$ with $\emph{s} \overset{a, i}{\rightarrow} \emph{s'}$ and $\mathcal{T}_{PHFL}, \emph{s'}
        \models \psi_{PHFL}$

        iff $\exists \emph{s'}$ with $(s_i, a, {s_i}') \in \Delta_{PHFL}$ and $\mathcal{T}_{PHFL}, \emph{s'}
        \models \psi_{PHFL}$

        iff $\exists \emph{s'}$ with $(\emph{s}, a_i, \emph{s'}) \in \Delta_{HFL}$ and by induction hypothesis it
        exists $\psi_{HFL}$ such that $\mathcal{T}_{HFL}, \emph{s'} \models \psi_{HFL}$

        iff $\mathcal{T}_{HFL}, \emph{s} \models \varphi_{HFL}$ where $\varphi_{HFL} = \langle a_i \rangle \psi_{HFL}$.
        \item $\varphi_{PHFL} = \{(i_1, \dots, i_n) \leftarrow (j_1, \dots, j_n)\} \psi_{PHFL} \colon $

        $\mathcal{T}_{PHFL}, \emph{s} \models \varphi_{PHFL}$

        iff $\exists \emph{s'}$ and $\exists a_1, \dots, a_n \in \Sigma$ with $(s_{i_1}, a_1, {s'}_{j_1}), \dots,
        (s_{i_n}, a_n, {s'}_{j_n}) \in \Delta_{PHFL}$ and $\mathcal{T}_{PHFL}, \emph{s'} \models \psi_{PHFL}$

        iff $\exists \emph{s'}$ with $(\emph{s}, s_{(i_1, \dots, i_n) \leftarrow (j_1, \dots, j_n)}, \emph{s'}) \in
        \Delta_{HFL}$ and by induction hypothesis it exists $\psi_{HFL}$ such that $\mathcal{T}_{HFL}, \emph{s'}
        \models \psi_{HFL}$

        iff $\mathcal{T}_{HFL}, \emph{s} \models \varphi_{HFL}$ where $\varphi_{HFL} = \langle s_{(i_1, \dots, i_n)
        \leftarrow (j_1, \dots, j_n)} \rangle \psi_{HFL}$.
    \end{compactitem}
    This shows the correctness of the construction and so that the model checking problem of PHFL$^k$ is reducable to
    the model checking problem of HFL$^k$.
\end{proof}

The following example shows the transforming of a LTS for the model check of a $2$-adic PHFL$^k$ formula to the LTS for
the model check of the transformed HFL$^k$ formula.

\begin{example}
    \label{example:upper_bounds_phfl_k}
    Let $\mathcal{T}_{PHFL}$ the LTS for the model check $\mathcal{T}_{PHFL}, \emph{s} \overset{?}{\models}
    \varphi_{PHFL}$ and $\mathcal{T}_{HFL}$ the, after the proof of Lemma~\ref{lemma:model_check_phfl_k} described
    transformation
    process, LTS for the model check $\mathcal{T}_{HFL}, \emph{s} \overset{?}{\models} \varphi_{PHFL}$.
    \begin{center}
        \begin{tikzpicture}[]
            \node [place] (q1) {$1$};
            \node  (temp1) [left=of q1] {};
            \node  (label) [left=of q1] {$\mathcal{T}_{PHFL}:$};
            \node  (temp2) [right=of q1] {};
            \node [place] (q2) [below=of temp2,label=left:$p$] {$2$}
            edge [pre] node[left] {a} (q1);
            \node [place] (q3) [right=of temp2,label=right:$q$] {$3$}
            edge [pre] node[auto, swap] {b} (q1)
            edge [pre] node[right] {c} (q2);
        \end{tikzpicture}
    \end{center}
    \begin{center}
        \begin{tikzpicture}[]
            \node [place] (q11) {$(1, 1)$};
            \node (label) [left=of q11] {$\mathcal{T}_{HFL}:$};
            \node  (temp1) [right=of q11] {};
            \node [place] (q12) [right=of temp1,label=above:{$p_2$}] {$(1, 2)$}
            edge [pre] node[above] {$a_2$} (q11);
            \node  (temp2) [right=of q12] {};
            \node [place] (q13) [right=of temp2, label=above:{$q_2$}] {$(1, 3)$}
            edge [pre] node[above] {$c_2$} (q12)
            edge [pre, bend right=40] node[above] {$b_2$} (q11);
            \node [place] (q21) [below=of q11,label=left:{$p_1$}] {$(2, 1)$}
            edge [pre] node[left] {$a_1$} (q11);
            \node [place] (q22) [below=of q12,label=right:{$p_1, p_2$}] {$(2, 2)$}
            edge [pre, bend right] node[above] {$a_2, s_{(2)\leftarrow(1)}$} (q21)
            edge [pre] node[right] {$a_1, s_{(1)\leftarrow(2)}$} (q12);
            \node [place] (q23) [below=of q13,label=right:{$p_1, q_2$}] {$(2, 3)$}
            edge [pre, bend right=30] node[below] {$c_2$} (q22)
            edge [pre] node[right] {$a_1$} (q13)
            edge [pre, bend left=18] node[right, below] {$b_2$} (q21);
            \node [place] (q31) [below=of q21,label=below:{$q_1$}] {$(3, 1)$}
            edge [pre, bend left=80] node[left] {$b_1$} (q11)
            edge [pre] node[left] {$c_1$} (q21);
            \node [place] (q32) [below=of q22,label=below:{$q_1, p_2$}] {$(3, 2)$}
            edge [pre] node[above] {$a_2, s_{(2)\leftarrow(1)}$} (q31)
            edge [pre, bend left=28] node[left] {$b_1$} (q12)
            edge [pre, bend right=40] node[right] {$c_1$} (q22);
            \node [place] (q33) [below=of q23,label=below:{$q_1, q_2$}] {$(3, 3)$}
            edge [pre] node[above] {$c_2, s_{(2)\leftarrow(1)}$} (q32)
            edge [pre, bend left=40] node[right] {$c_1, s_{(1)\leftarrow(2)}$} (q23)
            edge [pre, bend right=80] node[right] {$b_1, s_{(1)\leftarrow(2)}$} (q13)
            edge [pre, bend left=40] node[right, below] {$b_2, s_{(2)\leftarrow(1)}$} (q31);
        \end{tikzpicture}
    \end{center}
\end{example}

The following theorem is given by Lemma~\ref{lemma:model_check_phfl_k} and Theorem~\ref{theorem:hfl_k_in_k_exptime}.

\begin{theorem}
    \label{theorem:phfl_k_in_k_exptime}
    The model checking problem of PHFL$^k$ formulas lies in $k$-EXPTIME, where $k > 0$.
\end{theorem}